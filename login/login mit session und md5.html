<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>login mit session und md5</title>
             
  <meta http-equiv="content-type"
 content="text/html; charset=ISO-8859-1">
</head>
<body>
  <big><b>Loginsystems mit PHP. sessions und md5 Verschl&uuml;sselung<br>
  </b></big>In diesem Tutorial soll es um die Erstellung eines Loginsystems
 mit PHP gehen. Die Daten werden mit Hilfe von Sessions zwischen den Seiten
 &uuml;bergeben. Die Benutzerdaten soll sich das Script aus einer mySQL-Datenbank
 holen.<br>
   <b>1. Anlegen der Datenbank</b><br>
   Legen sie zun&auml;chste bitte eine neue Datenbank mit dem Namen "LoginSystem" 
 an. Als Grundfelder f&uuml;r die Datenbank ben&ouml;tigen Sie eigentlich
 nur ID, Nickname und Kennwort. Um allerdings ein Beispiel zu geben wie man
 mehrere Daten eines Benutzers in einer Session speichert, f&uuml;gen wir
noch die Felder Nachname und Vorname an um auf jeder Seite den Namen des
eingeloggten Benutzers anzuzeigen.<br>
   <br>
   Legen Sie als erstes eine neue Tabelle an, die "benutzerdaten" hei&szlig;t.
 Sie k&ouml;nnen dazu folgenden SQL-Befehl nutzen:<br>
     
<div style="margin: 5px 20px 20px;"> 	  
<div class="smallfont" style="margin-bottom: 2px;">PHP-Code:</div>
   	  
<div class="alt2"
 style="border: 1px inset ; margin: 0px; padding: 3px; width: 500px; height: 146px; overflow: auto;"> 
 		<code style="white-space: nowrap;"> 		  
<div dir="ltr" style="text-align: left;"> 			<!-- php buffer start --><code><font
 color="#000000"> <font color="#0000bb"> CREATE TABLE benutzerdaten </font><font
 color="#007700">( <br>
  &nbsp;&nbsp;</font><font color="#0000bb">Id Int</font><font
 color="#007700">(</font><font color="#0000bb">11</font><font
 color="#007700">) </font><font color="#0000bb">NOT NULL auto_increment</font><font
 color="#007700">, <br>
  &nbsp;&nbsp;</font><font color="#0000bb">Nickname VarChar</font><font
 color="#007700">(</font><font color="#0000bb">50</font><font
 color="#007700">) </font><font color="#0000bb">NOT NULL </font><font
 color="#007700">default </font><font color="#dd0000">''</font><font
 color="#007700">, <br>
  &nbsp;&nbsp;</font><font color="#0000bb">Kennwort VarChar</font><font
 color="#007700">(</font><font color="#0000bb">50</font><font
 color="#007700">) </font><font color="#0000bb">NOT NULL </font><font
 color="#007700">default </font><font color="#dd0000">''</font><font
 color="#007700">, <br>
  &nbsp;&nbsp;</font><font color="#0000bb">Nachname VarChar</font><font
 color="#007700">(</font><font color="#0000bb">50</font><font
 color="#007700">) </font><font color="#0000bb">NOT NULL </font><font
 color="#007700">default </font><font color="#dd0000">''</font><font
 color="#007700">, <br>
  &nbsp;&nbsp;</font><font color="#0000bb">Vorname VarChar</font><font
 color="#007700">(</font><font color="#0000bb">50</font><font
 color="#007700">) </font><font color="#0000bb">NOT NULL </font><font
 color="#007700">default </font><font color="#dd0000">''</font><font
 color="#007700">, <br>
  &nbsp;&nbsp;</font><font color="#0000bb">PRIMARY KEY </font><font
 color="#007700">(</font><font color="#0000bb">Id</font><font
 color="#007700">) <br>
  )  <br>
  </font> </font> </code><!-- php buffer end --> 		</div>
   		</code> 	</div>
   </div>
  <b>2. Einf&uuml;gen von Testbenutzern in die Datenbank</b><br>
   Jetzt wollen wir einige Testbenutzer in die Datenbank einf&uuml;gen. Da
 das Kennwort zus&auml;tzlich noch verschl&uuml;sselt werden soll, machen
wir das mit einem Script.<br>
     
<div style="margin: 5px 20px 20px;"> 	  
<div class="smallfont" style="margin-bottom: 2px;">PHP-Code:</div>
   	  
<div class="alt2"
 style="border: 1px inset ; margin: 0px; padding: 3px; width: 500px; height: 498px; overflow: auto;"> 
 		<code style="white-space: nowrap;"> 		  
<div dir="ltr" style="text-align: left;"> 			<!-- php buffer start --><code><font
 color="#000000"> <font color="#0000bb">&lt;?php  <br>
  </font><font color="#ff8000">// Definition der Benutzer  <br>
  </font><font color="#0000bb">$benutzer</font><font color="#007700">[</font><font
 color="#0000bb">0</font><font color="#007700">][</font><font
 color="#dd0000">"Nickname"</font><font color="#007700">] =</font><font
 color="#dd0000">"admin"</font><font color="#007700">;  <br>
  </font><font color="#0000bb">$benutzer</font><font color="#007700">[</font><font
 color="#0000bb">0</font><font color="#007700">][</font><font
 color="#dd0000">"Kennwort"</font><font color="#007700">] = </font><font
 color="#dd0000">"admin"</font><font color="#007700">;  <br>
  </font><font color="#0000bb">$benutzer</font><font color="#007700">[</font><font
 color="#0000bb">0</font><font color="#007700">][</font><font
 color="#dd0000">"Nachname"</font><font color="#007700">] = </font><font
 color="#dd0000">"Mustermann"</font><font color="#007700">;  <br>
  </font><font color="#0000bb">$benutzer</font><font color="#007700">[</font><font
 color="#0000bb">0</font><font color="#007700">][</font><font
 color="#dd0000">"Vorname"</font><font color="#007700">] = </font><font
 color="#dd0000">"Max"</font><font color="#007700">;  <br>
   <br>
  </font><font color="#0000bb">$benutzer</font><font color="#007700">[</font><font
 color="#0000bb">1</font><font color="#007700">][</font><font
 color="#dd0000">"Nickname"</font><font color="#007700">] = </font><font
 color="#dd0000">"test"</font><font color="#007700">;  <br>
  </font><font color="#0000bb">$benutzer</font><font color="#007700">[</font><font
 color="#0000bb">1</font><font color="#007700">][</font><font
 color="#dd0000">"Kennwort"</font><font color="#007700">] = </font><font
 color="#dd0000">"abc"</font><font color="#007700">;  <br>
  </font><font color="#0000bb">$benutzer</font><font color="#007700">[</font><font
 color="#0000bb">1</font><font color="#007700">][</font><font
 color="#dd0000">"Nachname"</font><font color="#007700">] = </font><font
 color="#dd0000">"Kunze"</font><font color="#007700">;  <br>
  </font><font color="#0000bb">$benutzer</font><font color="#007700">[</font><font
 color="#0000bb">1</font><font color="#007700">][</font><font
 color="#dd0000">"Vorname"</font><font color="#007700">] = </font><font
 color="#dd0000">"Martin"</font><font color="#007700">;  <br>
   <br>
  </font><font color="#ff8000">// Sie k&ouml;nnen an dieser Stelle beliebig
 viele Benutzer anlegen.  <br>
  // Achten Sie dabei nur auf die Fortf&uuml;hrung der Nummer.  <br>
   <br>
  // Aufbau der Datenbankverbindung  <br>
  </font><font color="#0000bb">$connectionid&nbsp;&nbsp;</font><font
 color="#007700">= </font><font color="#0000bb">mysql_connect </font><font
 color="#007700">(</font><font color="#dd0000">"localhost"</font><font
 color="#007700">, </font><font color="#dd0000">"root"</font><font
 color="#007700">, </font><font color="#dd0000">""</font><font
 color="#007700">);  <br>
  if (!</font><font color="#0000bb">mysql_select_db </font><font
 color="#007700">(</font><font color="#dd0000">"LoginSystem"</font><font
 color="#007700">, </font><font color="#0000bb">$connectionid</font><font
 color="#007700">))  <br>
  {  <br>
  &nbsp;&nbsp;die (</font><font color="#dd0000">"Keine Verbindung zur Datenbank"</font><font
 color="#007700">);  <br>
  }  <br>
   <br>
  </font><font color="#ff8000">// Zuerst alle Datens&auml;tze l&ouml;schen
 um keine Dopplungen zu bekommen.  <br>
  </font><font color="#0000bb">mysql_query </font><font color="#007700">(</font><font
 color="#dd0000">"DELETE FROM benutzerdaten"</font><font color="#007700">);
  <br>
   <br>
  </font><font color="#ff8000">// Daten eintragen  <br>
  </font><font color="#007700">while (list (</font><font color="#0000bb">$key</font><font
 color="#007700">, </font><font color="#0000bb">$value</font><font
 color="#007700">) = </font><font color="#0000bb">each </font><font
 color="#007700">(</font><font color="#0000bb">$benutzer</font><font
 color="#007700">))  <br>
  {  <br>
  &nbsp;&nbsp;</font><font color="#ff8000">// SQL-Anweisung erstellen  <br>
  &nbsp;&nbsp;</font><font color="#0000bb">$sql </font><font
 color="#007700">= </font><font color="#dd0000">"INSERT INTO "</font><font
 color="#007700">. <br>
  &nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#dd0000">"benutzerdaten (Nickname,
 Kennwort, Nachname, Vorname) "</font><font color="#007700">. <br>
  &nbsp;&nbsp;</font><font color="#dd0000">"VALUES ('"</font><font
 color="#007700">.</font><font color="#0000bb">$value</font><font
 color="#007700">[</font><font color="#dd0000">"Nickname"</font><font
 color="#007700">].</font><font color="#dd0000">"', '"</font><font
 color="#007700">. <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font
 color="#0000bb">md5 </font><font color="#007700">(</font><font
 color="#0000bb">$value</font><font color="#007700">[</font><font
 color="#dd0000">"Kennwort"</font><font color="#007700">]).</font><font
 color="#dd0000">"', '"</font><font color="#007700">. <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font
 color="#0000bb">$value</font><font color="#007700">[</font><font
 color="#dd0000">"Nachname"</font><font color="#007700">].</font><font
 color="#dd0000">"', '"</font><font color="#007700">. <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font
 color="#0000bb">$value</font><font color="#007700">[</font><font
 color="#dd0000">"Vorname"</font><font color="#007700">].</font><font
 color="#dd0000">"')"</font><font color="#007700">;  <br>
  &nbsp;&nbsp;</font><font color="#0000bb">mysql_query </font><font
 color="#007700">(</font><font color="#0000bb">$sql</font><font
 color="#007700">);  <br>
   <br>
  &nbsp;&nbsp;if (</font><font color="#0000bb">mysql_affected_rows </font><font
 color="#007700">(</font><font color="#0000bb">$connectionid</font><font
 color="#007700">) &gt; </font><font color="#0000bb">0</font><font
 color="#007700">)  <br>
  &nbsp;&nbsp;{  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#dd0000">"Benutzer erfolgreich
 angelegt.&lt;br&gt;\n"</font><font color="#007700">;  <br>
  &nbsp;&nbsp;}  <br>
  &nbsp;&nbsp;else  <br>
  &nbsp;&nbsp;{  <br>
  &nbsp;&nbsp;&nbsp;echo </font><font color="#dd0000">"Fehler beim Anlegen
 der Benutzer.&lt;br&gt;\n"</font><font color="#007700">;  <br>
  &nbsp;&nbsp;}  <br>
  }  <br>
  </font><font color="#0000bb">?&gt;</font> </font> </code><!-- php buffer end --> 
 		</div>
   		</code> 	</div>
   </div>
  <b>3. Das Formular zum Eingeben der Zugangsdaten</b><br>
   Jetzt legen wir eine Datei an, die das Loginformular enth&auml;lt. Das 
k&ouml;nnte  theoretisch auch eine reine HTML-Datei sein. Wir erstellen an 
dieser Stelle  allerdings eine PHP-Datei da bei einem falschen Passwort &uuml;ber 
dem Formular  eine Meldung ausgegeben werden soll.<br>
   Bitte beachten Sie, dass f&uuml;r den korrekten Ablauf der Funktionen
alle  hier erstellten Dateien im gleichen Verzeichnis liegen m&uuml;ssen.<br>
   <b>Hinweis</b><br>
   In diesem Tutorial soll nicht auf das Design der Seiten geachtet werden.
 Damit alles &uuml;bersichtlich bleibt, verzichten wir auf jegliche Formatierung
 der Objekte.<br>
   <b>formular.php</b><br>
     
<div style="margin: 5px 20px 20px;"> 	  
<div class="smallfont" style="margin-bottom: 2px;">PHP-Code:</div>
   	  
<div class="alt2"
 style="border: 1px inset ; margin: 0px; padding: 3px; width: 500px; height: 338px; overflow: auto;"> 
 		<code style="white-space: nowrap;"> 		  
<div dir="ltr" style="text-align: left;"> 			<!-- php buffer start --><code><font
 color="#000000"> <font color="#0000bb">&lt;?php session_start </font><font
 color="#007700">(); </font><font color="#0000bb">?&gt; <br>
  </font>&lt;html&gt; <br>
  &lt;head&gt; <br>
  &nbsp;&nbsp;&lt;title&gt;Login&lt;/title&gt; <br>
  &lt;/head&gt; <br>
   <br>
  &lt;body&gt; <br>
  <font color="#0000bb">&lt;?php  <br>
  </font><font color="#007700">if (isset (</font><font color="#0000bb">$_REQUEST</font><font
 color="#007700">[</font><font color="#dd0000">"fehler"</font><font
 color="#007700">]))  <br>
  {  <br>
  &nbsp;&nbsp;echo </font><font color="#dd0000">"Die Zugangsdaten waren ung&uuml;ltig."</font><font
 color="#007700">;  <br>
  }  <br>
  </font><font color="#0000bb">?&gt;</font> <br>
  &lt;form action="login.php" method="post"&gt; <br>
  &nbsp;&nbsp;Name: &lt;input type="text" name="name" size="20"&gt;&lt;br&gt;
 <br>
  &nbsp;&nbsp;Kennwort: &lt;input type="password" name="pwd" size="20"&gt;&lt;br&gt;
 <br>
  &nbsp;&nbsp;&lt;input type="submit" value="Login"&gt; <br>
  &lt;/form&gt; <br>
  &lt;/body&gt; <br>
  &lt;/html&gt;</font> </code><!-- php buffer end --><br>
</div>
   		</code> 	</div>
   </div>
   <b>4. Das Login</b><br>
   In dieser Datei werden die Zugangsdaten gepr&uuml;ft. Sind diese richtig, 
 werden die Benutzerdaten in einer Session gespeichert und auf eine Inhaltsseite 
 weitergeleiten, die nur zu sehen ist wenn der Benutzer eingeloggt ist.<br>
   <b>login.php</b><br>
     
<div style="margin: 5px 20px 20px;"> 	  
<div class="smallfont" style="margin-bottom: 2px;">PHP-Code:</div>
   	  
<div class="alt2"
 style="border: 1px inset ; margin: 0px; padding: 3px; width: 500px; height: 498px; overflow: auto;"> 
 		<code style="white-space: nowrap;"> 		  
<div dir="ltr" style="text-align: left;"> 			<!-- php buffer start --><code><font
 color="#000000"> <font color="#0000bb">&lt;?php  <br>
  </font><font color="#ff8000">// Session starten <br>
  </font><font color="#0000bb">session_start </font><font
 color="#007700">();  <br>
   <br>
  </font><font color="#ff8000">// Datenbankverbindung aufbauen  <br>
  </font><font color="#0000bb">$connectionid </font><font
 color="#007700">=  </font><font color="#0000bb">mysql_connect </font><font
 color="#007700">(</font><font color="#dd0000">"localhost"</font><font
 color="#007700">, </font><font color="#dd0000">"root"</font><font
 color="#007700">, </font><font color="#dd0000">""</font><font
 color="#007700">);  <br>
  if (!</font><font color="#0000bb">mysql_select_db </font><font
 color="#007700">(</font><font color="#dd0000">"LoginSystem"</font><font
 color="#007700">, </font><font color="#0000bb">$connectionid</font><font
 color="#007700">))  <br>
  {  <br>
  &nbsp;&nbsp;die (</font><font color="#dd0000">"Keine Verbindung zur Datenbank"</font><font
 color="#007700">);  <br>
  }  <br>
   <br>
  </font><font color="#0000bb">$sql </font><font color="#007700">= </font><font
 color="#dd0000">"SELECT "</font><font color="#007700">.  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#dd0000">"Id, Nickname, Nachname,
 Vorname "</font><font color="#007700">.  <br>
  &nbsp;&nbsp;</font><font color="#dd0000">"FROM "</font><font
 color="#007700">.  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#dd0000">"benutzerdaten "</font><font
 color="#007700">.  <br>
  &nbsp;&nbsp;</font><font color="#dd0000">"WHERE "</font><font
 color="#007700">.  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#dd0000">"(Nickname like '"</font><font
 color="#007700">.</font><font color="#0000bb">$_REQUEST</font><font
 color="#007700">[</font><font color="#dd0000">"name"</font><font
 color="#007700">].</font><font color="#dd0000">"') AND "</font><font
 color="#007700">.  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#dd0000">"(Kennwort = '"</font><font
 color="#007700">.</font><font color="#0000bb">md5 </font><font
 color="#007700">(</font><font color="#0000bb">$_REQUEST</font><font
 color="#007700">[</font><font color="#dd0000">"pwd"</font><font
 color="#007700">]).</font><font color="#dd0000">"')"</font><font
 color="#007700">;  <br>
  </font><font color="#0000bb">$result </font><font color="#007700">= </font><font
 color="#0000bb">mysql_query </font><font color="#007700">(</font><font
 color="#0000bb">$sql</font><font color="#007700">);  <br>
   <br>
  if (</font><font color="#0000bb">mysql_num_rows </font><font
 color="#007700">(</font><font color="#0000bb">$result</font><font
 color="#007700">) &gt; </font><font color="#0000bb">0</font><font
 color="#007700">)  <br>
  {  <br>
  &nbsp;&nbsp;</font><font color="#ff8000">// Benutzerdaten in ein Array
auslesen.   <br>
  &nbsp;&nbsp;</font><font color="#0000bb">$data </font><font
 color="#007700">= </font><font color="#0000bb">mysql_fetch_array </font><font
 color="#007700">(</font><font color="#0000bb">$result</font><font
 color="#007700">);  <br>
   <br>
  &nbsp;&nbsp;</font><font color="#ff8000">// Sessionvariablen erstellen
und  registrieren  <br>
  &nbsp;&nbsp;</font><font color="#0000bb">$_SESSION</font><font
 color="#007700">[</font><font color="#dd0000">"user_id"</font><font
 color="#007700">] = </font><font color="#0000bb">$data</font><font
 color="#007700">[</font><font color="#dd0000">"Id"</font><font
 color="#007700">];  <br>
  &nbsp;&nbsp;</font><font color="#0000bb">$_SESSION</font><font
 color="#007700">[</font><font color="#dd0000">"user_nickname"</font><font
 color="#007700">] = </font><font color="#0000bb">$data</font><font
 color="#007700">[</font><font color="#dd0000">"Nickname"</font><font
 color="#007700">];  <br>
  &nbsp;&nbsp;</font><font color="#0000bb">$_SESSION</font><font
 color="#007700">[</font><font color="#dd0000">"user_nachname"</font><font
 color="#007700">] = </font><font color="#0000bb">$data</font><font
 color="#007700">[</font><font color="#dd0000">"Nachname"</font><font
 color="#007700">];  <br>
  &nbsp;&nbsp;</font><font color="#0000bb">$_SESSION</font><font
 color="#007700">[</font><font color="#dd0000">"user_vorname"</font><font
 color="#007700">] = </font><font color="#0000bb">$data</font><font
 color="#007700">[</font><font color="#dd0000">"Vorname"</font><font
 color="#007700">];  <br>
   <br>
  &nbsp;&nbsp;</font><font color="#0000bb">header </font><font
 color="#007700">(</font><font color="#dd0000">"Location: intern.php"</font><font
 color="#007700">);  <br>
  }  <br>
  else  <br>
  {  <br>
  &nbsp;&nbsp;</font><font color="#0000bb">header </font><font
 color="#007700">(</font><font color="#dd0000">"Location: formular.php?fehler=1"</font><font
 color="#007700">);  <br>
  }  <br>
  </font><font color="#0000bb">?&gt;</font> </font> </code><!-- php buffer end --><br>
</div>
   		</code> 	</div>
   </div>
   <b>5. &Uuml;berpr&uuml;fung des Loginstatus f&uuml;r die Inhaltsseiten</b><br>
   <br>
   Diese Datei soll daf&uuml;r sorgen, dass bei jedem Aufruf einer Seite
die  Daten in der Session &uuml;berpr&uuml;ft werden. Bemerkt das Script,
dass  ein Benutzer eingeloggt ist wird der Inhalt der Seite ausgegeben. Ist
dies  nicht der Fall wird der Benutzer auf das Loginformular umgeleitet.<br>
   <b>checkuser.php</b><br>
     
<div style="margin: 5px 20px 20px;"> 	  
<div class="smallfont" style="margin-bottom: 2px;">PHP-Code:</div>
   	  
<div class="alt2"
 style="border: 1px inset ; margin: 0px; padding: 3px; width: 500px; height: 130px; overflow: auto;"> 
 		<code style="white-space: nowrap;"> 		  
<div dir="ltr" style="text-align: left;"> 			<!-- php buffer start --><code><font
 color="#000000"> <font color="#0000bb">&lt;?php  <br>
  session_start </font><font color="#007700">();  <br>
  if (!isset (</font><font color="#0000bb">$_SESSION</font><font
 color="#007700">[</font><font color="#dd0000">"user_id"</font><font
 color="#007700">]))  <br>
  {  <br>
  &nbsp;&nbsp;</font><font color="#0000bb">header </font><font
 color="#007700">(</font><font color="#dd0000">"Location: formular.php"</font><font
 color="#007700">);  <br>
  }  <br>
  </font><font color="#0000bb">?&gt;</font> </font> </code><!-- php buffer end --><br>
</div>
   		</code> 	</div>
   </div>
   Diese Datei wird nicht direkt aufgerufen, sondern per include() am Anfang 
 jeder Seite eingef&uuml;gt. Wie das funktioniert sehen sie im n&auml;chsten
 Punkt.<br>
   <b>6. Die interne Datei</b><br>
   Jetzt wollen wir die Seite erstellen, die nur angezeigt wird wenn der
Benutzer  eingeloggt ist. Auf dieser Seite sollen die Benutzerdaten wieder
ausgegeben  werden. Ist der Benutzer nicht eingeloggt wird er automatisch
durch die eingef&uuml;gte  Datei auf das Loginformular weitergeleitet.<br>
   <b>intern.php</b><br>
     
<div style="margin: 5px 20px 20px;"> 	  
<div class="smallfont" style="margin-bottom: 2px;">PHP-Code:</div>
   	  
<div class="alt2"
 style="border: 1px inset ; margin: 0px; padding: 3px; width: 500px; height: 274px; overflow: auto;"> 
 		<code style="white-space: nowrap;"> 		  
<div dir="ltr" style="text-align: left;"> 			<!-- php buffer start --><code><font
 color="#000000"> <font color="#0000bb">&lt;?php  <br>
  </font><font color="#007700">include (</font><font color="#dd0000">"checkuser.php"</font><font
 color="#007700">);  <br>
  </font><font color="#0000bb">?&gt;</font> <br>
  &lt;html&gt; <br>
  &lt;head&gt; <br>
  &nbsp;&nbsp;&lt;title&gt;Interne Seite&lt;/title&gt; <br>
  &lt;/head&gt; <br>
  &lt;body&gt; <br>
  &nbsp;&nbsp;BenutzerId: <font color="#0000bb">&lt;?php </font><font
 color="#007700">echo </font><font color="#0000bb">$_SESSION</font><font
 color="#007700">[</font><font color="#dd0000">"user_id"</font><font
 color="#007700">]; </font><font color="#0000bb">?&gt;</font>&lt;br&gt; <br>
  &nbsp;&nbsp;Nickname: <font color="#0000bb">&lt;?php </font><font
 color="#007700">echo </font><font color="#0000bb">$_SESSION</font><font
 color="#007700">[</font><font color="#dd0000">"user_nickname"</font><font
 color="#007700">]; </font><font color="#0000bb">?&gt;</font>&lt;br&gt; <br>
  &nbsp;&nbsp;Nachname: <font color="#0000bb">&lt;?php </font><font
 color="#007700">echo </font><font color="#0000bb">$_SESSION</font><font
 color="#007700">[</font><font color="#dd0000">"user_nachname"</font><font
 color="#007700">]; </font><font color="#0000bb">?&gt;</font>&lt;br&gt; <br>
  &nbsp;&nbsp;Vorname: <font color="#0000bb">&lt;?php </font><font
 color="#007700">echo </font><font color="#0000bb">$_SESSION</font><font
 color="#007700">[</font><font color="#dd0000">"user_vorname"</font><font
 color="#007700">]; </font><font color="#0000bb">?&gt;</font> <br>
  &nbsp;&nbsp;&lt;hr&gt; <br>
  &nbsp;&nbsp;&lt;a href="logout.php"&gt;Ausloggen&lt;/a&gt; <br>
  &lt;/body&gt; <br>
  &lt;/html&gt;</font> </code><!-- php buffer end --><br>
</div>
   		</code> 	</div>
   </div>
   <b>7. Das Logout</b><br>
   <br>
   Ganz zum Schluss wollen wir noch schnell die Datei f&uuml;r die Logout-Funktion 
 schreiben. Diese Datei l&ouml;scht die Inhalte der Session und leitet auf
 das Loginformular weiter.<br>
   <b>logout.php</b><br>
     
<div style="margin: 5px 20px 20px;"> 	  
<div class="smallfont" style="margin-bottom: 2px;">PHP-Code:</div>
   	  
<div class="alt2"
 style="border: 1px inset ; margin: 0px; padding: 3px; width: 500px; height: 194px; overflow: auto;"> 
 		<code style="white-space: nowrap;"> 		  
<div dir="ltr" style="text-align: left;"> 			<!-- php buffer start --><code><font
 color="#000000"> <font color="#0000bb">&lt;?php  <br>
  </font><font color="#ff8000">// Wird ausgef&uuml;hrt um mit der Ausgabe 
des Headers zu warten.  <br>
  </font><font color="#0000bb">ob_start </font><font color="#007700">();
 <br>
   <br>
  </font><font color="#0000bb">session_start </font><font
 color="#007700">();   <br>
  </font><font color="#0000bb">session_unset </font><font
 color="#007700">();   <br>
  </font><font color="#0000bb">session_destroy </font><font
 color="#007700">();  <br>
   <br>
  </font><font color="#0000bb">header </font><font color="#007700">(</font><font
 color="#dd0000">"Location: formular.php"</font><font color="#007700">);
 <br>
  </font><font color="#0000bb">ob_end_flush </font><font color="#007700">();
  <br>
  </font><font color="#0000bb">?&gt;</font> </font> </code><!-- php buffer end --><br>
</div>
   		</code> 	</div>
   </div>
   <b>8. Ausprobieren</b><br>
   Jetzt sind alle Versuchsdateien angelegt und wir k&ouml;nnen es jetzt
ausprobieren.  Vergewissern Sie sich noch einmal, dass alle Dateien im gleichen
Verzeichnis  liegen und rufen Sie dann einmal die Datei intern.php auf. Da
Sie sich ja  noch nicht eingeloggt haben m&uuml;sste die in intern.php per
include() eingef&uuml;gte  Datei checkuser.php Sie auf formular.php umleiten.
Geben Sie nun im Formular  einmal einen der beiden Benutzer an. (z.B. "admin"
mit Kennwort "admin" oder  "test" mit Kennwort "abc"). Das Formular schickt
die Daten an login.php welche  in der Datenbank die Werte &uuml;berpr&uuml;ft. 
Wurde der Benutzer gefunden werden die Werte in der Session gespeichert und 
Sie werden wieder an die Datei intern.php weitergeleitet. Nun sehen Sie dort 
die in der Session gespeicherten Daten. Solange Sie sich nicht auf Ausloggen 
klicken, k&ouml;nnen Sie beliebig zwischen Seiten wechseln, Sie bleiben eingeloggt, 
solange Sie sich nicht mit einem anderen Namen einloggen bzw. das Browserfenster 
schlie&szlig;en. Viel Spa&szlig; beim Probieren.  
</body>
</html>
